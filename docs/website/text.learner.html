<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Easy access of language models and ULMFiT">
<meta name="keywords" content=" fastai">
<title>text.learner | fastai</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico?">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="documentation-theme-jekyll" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

            // activate menu items where href is matching to current page
            $("#mysidebar a[href='" + location.pathname.match(/\/([^\/]*)$/)[1] + "']")
                .parents('li').addClass('active')
                .parents('ul').css('display', 'block');
        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> fastai</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="text.learner.html#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/fastai/fastai" target="_blank">GitHub</a></li>
                
                
                
                <li><a href="http://www.fast.ai" target="_blank">News</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="http://127.0.0.1:4000/{url}" title="text.learner">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a href="text.learner.html#">Getting started</a>
      <ul>
          
          
          
          <li><a href="https://github.com/fastai/fastai/blob/master/README.md#installation" target="_blank">Installation</a></li>
          
          
          
          
          
          
          <li><a href="https://docs-dev.fast.ai/troubleshoot" target="_blank">Troubleshooting</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="text.learner.html#">Training</a>
      <ul>
          
          
          
          <li><a href="training.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="basic_train.html">basic_train</a></li>
          
          
          
          
          
          
          <li><a href="train.html">train</a></li>
          
          
          
          
          
          
          <li><a href="metrics.html">metrics</a></li>
          
          
          
          
          
          
          <li><a href="callback.html">callback</a></li>
          
          
          
          <li class="subfolders">
              <a href="text.learner.html#">callbacks</a>
              <ul>
                  
                  
                  
                  <li><a href="callbacks.html">Overview</a></li>
                  
                  
                  
                  
                  
                  <li><a href="callbacks.hooks.html">HookCallback</a></li>
                  
                  
                  
                  
                  
                  <li><a href="callbacks.fp16.html">MixedPrecision</a></li>
                  
                  
                  
                  
                  
                  <li><a href="callbacks.one_cycle.html">OneCycleScheduler</a></li>
                  
                  
                  
                  
                  
                  <li><a href="callbacks.lr_finder.html">LRFinder</a></li>
                  
                  
                  
                  
                  
                  <li><a href="callbacks.mixup.html">MixUpCallback</a></li>
                  
                  
                  
                  
                  
                  <li><a href="callbacks.rnn.html">RNNTrainer</a></li>
                  
                  
                  
                  
                  
                  <li><a href="callbacks.general_sched.html">GeneralScheduler</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="text.learner.html#">Applications</a>
      <ul>
          
          
          
          <li><a href="applications.html">Overview</a></li>
          
          
          
          <li class="subfolders">
              <a href="text.learner.html#">vision</a>
              <ul>
                  
                  
                  
                  <li><a href="vision.html">Overview</a></li>
                  
                  
                  
                  
                  
                  <li><a href="vision.learner.html">vision.learner</a></li>
                  
                  
                  
                  
                  
                  <li><a href="vision.transform.html">vision.transform</a></li>
                  
                  
                  
                  
                  
                  <li><a href="vision.image.html">vision.image</a></li>
                  
                  
                  
                  
                  
                  <li><a href="vision.data.html">vision.data</a></li>
                  
                  
                  
                  
                  
                  <li><a href="vision.models.html">vision.model overview</a></li>
                  
                  
                  
                  
                  
                  <li><a href="vision.models.unet.html">vision.models.unet</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a href="text.learner.html#">text</a>
              <ul>
                  
                  
                  
                  <li><a href="text.html">Overview</a></li>
                  
                  
                  
                  
                  
                  <li><a href="text.learner.html">text.learner</a></li>
                  
                  
                  
                  
                  
                  <li><a href="text.transform.html">text.transform</a></li>
                  
                  
                  
                  
                  
                  <li><a href="text.data.html">text.data</a></li>
                  
                  
                  
                  
                  
                  <li><a href="text.models.html">text.models</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          <li class="subfolders">
              <a href="text.learner.html#">tabular</a>
              <ul>
                  
                  
                  
                  <li><a href="tabular.html">Overview</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tabular.transform.html">tabular.transform</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tabular.data.html">tabular.data</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tabular.models.html">tabular.models</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          
          
          
          <li><a href="collab.html">collab</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="text.learner.html#">Core</a>
      <ul>
          
          
          
          <li><a href="overview.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="basic_data.html">basic_data</a></li>
          
          
          
          
          
          
          <li><a href="layers.html">layers</a></li>
          
          
          
          
          
          
          <li><a href="datasets.html">datasets</a></li>
          
          
          
          
          
          
          <li><a href="core.html">core</a></li>
          
          
          
          
          
          
          <li><a href="torch_core.html">torch_core</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="text.learner.html#">Doc authoring</a>
      <ul>
          
          
          
          <li><a href="gen_doc.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="gen_doc.gen_notebooks.html">gen_doc.gen_notebooks</a></li>
          
          
          
          
          
          
          <li><a href="gen_doc.nbdoc.html">gen_doc.nbdoc</a></li>
          
          
          
          
          
          
          <li><a href="gen_doc.convert2html.html">gen_doc.convert2html</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="text.learner.html#">Library development</a>
      <ul>
          
          
          
          <li><a href="https://docs-dev.fast.ai/develop" target="_blank">Overview</a></li>
          
          
          
          
          
          
          <li><a href="https://docs-dev.fast.ai/test" target="_blank">Testing</a></li>
          
          
          
          
          
          
          <li><a href="https://docs-dev.fast.ai/style" target="_blank">Style guide</a></li>
          
          
          
          
          
          
          <li><a href="https://docs-dev.fast.ai/abbr" target="_blank">Abbreviation</a></li>
          
          
          
          
          
          
          <li><a href="fastai_typing.html">Typing</a></li>
          
          
          
          
          
          
          <li><a href="https://docs-dev.fast.ai/release" target="_blank">Packaging fastai</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
    <a id="text.learner"></a>
    <h1 class="post-title-main">text.learner</h1>
</div>



<div class="post-content">

   
    <div class="summary">Easy access of language models and ULMFiT</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

   <div class="container" id="notebook-container">
    
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="NLP-model-creation-and-training">NLP model creation and training<a class="anchor-link" href="text.learner.html#NLP-model-creation-and-training">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The main thing here is <a href="text.learner.html#RNNLearner"><code>RNNLearner</code></a>. There are also some utility functions to help create and update text models.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=RNNLearner></a><code>class</code> <code>RNNLearner</code></h2>
<blockquote><p><code>RNNLearner</code>(<code>data</code>:<a href="basic_data.html#DataBunch"><code>DataBunch</code></a>, <code>model</code>:<a href="https://pytorch.org/docs/stable/nn#torch.nn.Module"><code>Module</code></a>, <code>bptt</code>:<code>int</code>=<code>70</code>, <code>split_func</code>:<code>OptSplitFunc</code>=<code>None</code>, <code>clip</code>:<code>float</code>=<code>None</code>, <code>adjust</code>:<code>bool</code>=<code>False</code>, <code>alpha</code>:<code>float</code>=<code>2.0</code>, <code>beta</code>:<code>float</code>=<code>1.0</code>, <code>kwargs</code>) :: <a href="basic_train.html#Learner"><code>Learner</code></a>
<a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L43">[source]</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Handles the whole creation of a <a href="basic_train.html#Learner"><code>Learner</code></a> from <code>data</code> and a <code>model</code> with a text data using a certain <code>bptt</code>. The <code>split_func</code> is used to properly split the model in different groups for gradual unfreezing and differential learning rates. Gradient clipping of <code>clip</code> is optionally applied. <code>adjust</code>, <code>alpha</code> and <code>beta</code> are all passed to create an instance of <a href="callbacks.rnn.html#RNNTrainer"><code>RNNTrainer</code></a>. Can be used for a language model or an RNN classifier. It also handles the conversion of weights from a pretrained model as well as saving or loading the encoder.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Factory-methods">Factory methods<a class="anchor-link" href="text.learner.html#Factory-methods">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=classifier></a><code>classifier</code></h4>
<blockquote><p><code>classifier</code>(<code>data</code>:<a href="basic_data.html#DataBunch"><code>DataBunch</code></a>, <code>bptt</code>:<code>int</code>=<code>70</code>, <code>max_len</code>:<code>int</code>=<code>1400</code>, <code>emb_sz</code>:<code>int</code>=<code>400</code>, <code>nh</code>:<code>int</code>=<code>1150</code>, <code>nl</code>:<code>int</code>=<code>3</code>, <code>lin_ftrs</code>:<code>Collection</code>[<code>int</code>]=<code>None</code>, <code>ps</code>:<code>Collection</code>[<code>float</code>]=<code>None</code>, <code>pad_token</code>:<code>int</code>=<code>1</code>, <code>drop_mult</code>:<code>float</code>=<code>1.0</code>, <code>qrnn</code>:<code>bool</code>=<code>False</code>, <code>kwargs</code>) → <code>RNNLearner</code>
<a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L85">[source]</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create an RNNLearner with a classifier model from <a href="text.data.html#text.data"><code>data</code></a>. The model used is the encoder of an <a href="https://arxiv.org/abs/1708.02182">AWD-LSTM</a> that is built with embeddings of size <code>emb_sz</code>, a hidden size of <code>nh</code>, and <code>nl</code> layers (the <code>vocab_size</code> is inferred from the <a href="text.data.html#text.data"><code>data</code></a>). All the dropouts are put to values that we found worked pretty well and you can control their strength by adjusting <code>drop_mult</code>. If <a href="http://127.0.0.1:4000/text.qrnn.html#text.qrnn"><code>qrnn</code></a> is True, the model uses <a href="https://arxiv.org/abs/1611.01576">QRNN cells</a> instead of LSTMs.</p>
<p>The input texts are fed into that model by bunch of <code>bptt</code> and only the last <code>max_len</code> activations are considerated. This gives us the backbone of our model. The head then consists of:</p>
<ul>
<li>a layer that concatenates the final outputs of the RNN with the maximum and average of all the intermediate outputs (on the sequence length dimension),</li>
<li>blocks of (<a href="https://pytorch.org/docs/stable/nn#torch.nn.BatchNorm1d"><code>nn.BatchNorm1d</code></a>, <a href="https://pytorch.org/docs/stable/nn#torch.nn.Dropout"><code>nn.Dropout</code></a>, <a href="https://pytorch.org/docs/stable/nn#torch.nn.Linear"><code>nn.Linear</code></a>, <a href="https://pytorch.org/docs/stable/nn#torch.nn.ReLU"><code>nn.ReLU</code></a>) layers.</li>
</ul>
<p>The blocks are defined by the <code>lin_ftrs</code> and <code>drops</code> arguments. Specifically, the first block will have a number of inputs inferred from the backbone arch and the last one will have a number of outputs equal to data.c (which contains the number of classes of the data) and the intermediate blocks have a number of inputs/outputs determined by <code>lin_ftrs</code> (of course a block has a number of inputs equal to the number of outputs of the previous block). The dropouts all have a the same value ps if you pass a float, or the corresponding values if you pass a list. Default is to have an intermediate hidden size of 50 (which makes two blocks model_activation -&gt; 50 -&gt; n_classes) with a dropout of 0.1.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">get_imdb</span><span class="p">(</span><span class="n">classifier</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">RNNLearner</span><span class="o">.</span><span class="n">classifier</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">drop_mult</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=language_model></a><code>language_model</code></h4>
<blockquote><p><code>language_model</code>(<code>data</code>:<a href="basic_data.html#DataBunch"><code>DataBunch</code></a>, <code>bptt</code>:<code>int</code>=<code>70</code>, <code>emb_sz</code>:<code>int</code>=<code>400</code>, <code>nh</code>:<code>int</code>=<code>1150</code>, <code>nl</code>:<code>int</code>=<code>3</code>, <code>pad_token</code>:<code>int</code>=<code>1</code>, <code>drop_mult</code>:<code>float</code>=<code>1.0</code>, <code>tie_weights</code>:<code>bool</code>=<code>True</code>, <code>bias</code>:<code>bool</code>=<code>True</code>, <code>qrnn</code>:<code>bool</code>=<code>False</code>, <code>pretrained_fnames</code>:<code>OptStrTuple</code>=<code>None</code>, <code>kwargs</code>) → <code>RNNLearner</code>
<a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L70">[source]</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create an RNNLearner with a language model from <a href="text.data.html#text.data"><code>data</code></a> of a certain <code>bptt</code>. The model used is an <a href="https://arxiv.org/abs/1708.02182">AWD-LSTM</a> that is built with embeddings of size <code>emb_sz</code>, a hidden size of <code>nh</code>, and <code>nl</code> layers (the <code>vocab_size</code> is inferred from the <a href="text.data.html#text.data"><code>data</code></a>). All the dropouts are put to values that we found worked pretty well and you can control their strength by adjusting <code>drop_mult</code>. If <a href="http://127.0.0.1:4000/text.qrnn.html#text.qrnn"><code>qrnn</code></a> is True, the model uses <a href="https://arxiv.org/abs/1611.01576">QRNN cells</a> instead of LSTMs. The flag <code>tied_weights</code> control if we should use the same weights for the encoder and the decoder, the flag <code>bias</code> controls if the last linear layer (the decoder) has bias or not.</p>
<p>You can specify <code>pretrained_fnames</code> if you want to use the weights of a pretrained model. This should be a list of the name of the weight file and the name of the corresponding dictionary. The dictionary is needed because the function will internally convert the embeddings of the pretrained models to match the dictionary of the <a href="text.data.html#text.data"><code>data</code></a> passed (a word may have a different id for the pretrained model). Those two files should be in the models directory of <code>data.path</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">get_imdb</span><span class="p">()</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">RNNLearner</span><span class="o">.</span><span class="n">language_model</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pretrained_fnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lstm_wt103&#39;</span><span class="p">,</span> <span class="s1">&#39;itos_wt103&#39;</span><span class="p">],</span> <span class="n">drop_mult</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loading-and-saving">Loading and saving<a class="anchor-link" href="text.learner.html#Loading-and-saving">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=load_encoder></a><code>load_encoder</code></h4>
<blockquote><p><code>load_encoder</code>(<code>name</code>:<code>str</code>)</p>
</blockquote>
<p>Load the encoder <code>name</code> from the model directory.  <a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L57">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=save_encoder></a><code>save_encoder</code></h4>
<blockquote><p><code>save_encoder</code>(<code>name</code>:<code>str</code>)</p>
</blockquote>
<p>Save the encoder to <code>name</code> inside the model directory.  <a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L53">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=load_pretrained></a><code>load_pretrained</code></h4>
<blockquote><p><code>load_pretrained</code>(<code>wgts_fname</code>:<code>str</code>, <code>itos_fname</code>:<code>str</code>)
<a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L62">[source]</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Opens the weights in the <code>wgts_fname</code> of <code>self.model_dir</code> and the dictionary in <code>itos_fname</code> then adapts the pretrained weights to the vocabulary of the <code>data</code>. The two files should be in the models directory of the <code>learner.path</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Utility-functions">Utility functions<a class="anchor-link" href="text.learner.html#Utility-functions">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=lm_split></a><code>lm_split</code></h4>
<blockquote><p><code>lm_split</code>(<code>model</code>:<a href="https://pytorch.org/docs/stable/nn#torch.nn.Module"><code>Module</code></a>) → <code>List</code>[<a href="https://pytorch.org/docs/stable/nn#torch.nn.Module"><code>Module</code></a>]</p>
</blockquote>
<p>Split a RNN <code>model</code> in groups for differential learning rates.  <a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L28">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=rnn_classifier_split></a><code>rnn_classifier_split</code></h4>
<blockquote><p><code>rnn_classifier_split</code>(<code>model</code>:<a href="https://pytorch.org/docs/stable/nn#torch.nn.Module"><code>Module</code></a>) → <code>List</code>[<a href="https://pytorch.org/docs/stable/nn#torch.nn.Module"><code>Module</code></a>]</p>
</blockquote>
<p>Split a RNN <code>model</code> in groups for differential learning rates.  <a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L35">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=convert_weights></a><code>convert_weights</code></h4>
<blockquote><p><code>convert_weights</code>(<code>wgts</code>:<code>Weights</code>, <code>stoi_wgts</code>:<code>Dict</code>[<code>str</code>, <code>int</code>], <code>itos_new</code>:<code>StrList</code>) → <code>Weights</code>
<a href="https://github.com/fastai/fastai/blob/master/fastai/text/learner.py#L12">[source]</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Convert the <code>wgts</code> from an dictionary <code>stoi_wgts</code> (mapping of word to id) to a new dictionary <code>itos_new</code> (correspondans id to word).</p>

</div>
</div>
</div>
</div>
 



    <div class="tags">
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               <p><img src="images/company_logo.png" alt="Company logo"/></p>
               &copy;2018 fast.ai. All rights reserved. <br />
 Site last generated: Oct 22, 2018 <br />
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-89522379-3','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>
