---
title: data
keywords: 
sidebar: home_sidebar
tags: 
summary: "`fastai.data` loads and manages datasets with `DataBunch`"
---

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="data">data<a class="anchor-link" href="#data">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Type an introduction of the package here.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Global-Variable-Definitions:">Global Variable Definitions:<a class="anchor-link" href="#Global-Variable-Definitions:">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=DataBunch></a><code>class</code> <code>DataBunch</code></h2>
<blockquote><p><code>DataBunch</code>(<code>train_dl</code>:<code>DataLoader</code>, <code>valid_dl</code>:<code>DataLoader</code>, <code>test_dl</code>:<code>Optional</code>`DataLoader<code>\]=</code>None<code>,</code>device<code>:</code>device<code>=</code>None<code>,</code>tfms<code>:</code>Optional<code>\[</code>Collection<code>\[</code>Callable<code>\]\]=</code>None<code>,</code>path<code>:</code>PathOrStr<code>=</code>'.'<code>,</code>collate_fn<code>:</code>Callable<code>=</code>'data_collate'`)</p>
</blockquote>
<p>Bind <code>train_dl</code>,<code>valid_dl</code> and<code>test_dl</code> to <code>device</code>. tfms are DL tfms (normalize). <code>path</code> is for models. <a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L57">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DataBunch</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=_create_with_tfm></a><code>_create_with_tfm</code></h4>
<blockquote><p><code>_create_with_tfm</code>(<code>train_ds</code>, <code>valid_ds</code>, <code>test_ds</code>=<code>None</code>, <code>path</code>=<code>'.'</code>, <code>bs</code>=<code>64</code>, <code>ds_tfms</code>=<code>None</code>, <code>num_workers</code>=<code>8</code>, <code>tfms</code>=<code>None</code>, <code>device</code>=<code>None</code>, <code>size</code>=<code>None</code>, <code>kwargs</code>) -&gt; <code>DataBunch</code></p>
</blockquote>
<p><code>DataBunch</code> factory. <code>bs</code> batch size, <code>ds_tfms</code> for <code>Dataset</code>, <code>tfms</code> for <code>DataLoader</code>. <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/data.py#L187">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DataBunch.create</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=holdout></a><code>holdout</code></h4>
<blockquote><p><code>holdout</code>(<code>is_test</code>:<code>bool</code>=<code>False</code>) -&gt; <code>DeviceDataLoader</code></p>
</blockquote>
<p>Returns correct holdout <code>Dataset</code> for test vs validation (<code>is_test</code>). <a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L81">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DataBunch.holdout</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=_labels_to_csv></a><code>_labels_to_csv</code></h4>
<blockquote><p><code>_labels_to_csv</code>(<code>dest</code>:<code>str</code>)</p>
</blockquote>
<p>Save file names and labels in <code>data</code> as CSV to file name <code>dest</code>. <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/data.py#L214">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=DatasetBase></a><code>class</code> <code>DatasetBase</code></h2>
<blockquote><p><code>DatasetBase</code>() :: <code>Dataset</code></p>
</blockquote>
<p>Base class for all fastai datasets. <a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L6">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DatasetBase</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=DeviceDataLoader></a><code>class</code> <code>DeviceDataLoader</code></h2>
<blockquote><p><code>DeviceDataLoader</code>(<code>dl</code>:<code>DataLoader</code>, <code>device</code>:<code>device</code>, <code>tfms</code>:<code>List</code>[<code>Callable</code>]=<code>None</code>, <code>collate_fn</code>:<code>Callable</code>=<code>'data_collate'</code>)</p>
</blockquote>
<p>Bind a <code>DataLoader</code> to a <code>torch.device</code>. <a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L23">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DeviceDataLoader</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=add_tfm></a><code>add_tfm</code></h4>
<blockquote><p><code>add_tfm</code>(<code>tfm</code>:<code>Callable</code>)
<a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L36">[source]</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DeviceDataLoader.add_tfm</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=data_collate></a><code>data_collate</code></h4>
<blockquote><p><code>data_collate</code>(<code>batch</code>:<code>ItemsList</code>) -&gt; <code>Tensor</code></p>
</blockquote>
<p>Convert <code>batch</code> items to tensor data <a href="https://github.com/fastai/fastai/blob/master/fastai/torch_core.py#L78">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DeviceDataLoader.collate_fn</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=create></a><code>create</code></h4>
<blockquote><p><code>create</code>(<code>dataset</code>:<code>Dataset</code>, <code>bs</code>:<code>int</code>=<code>1</code>, <code>shuffle</code>:<code>bool</code>=<code>False</code>, <code>device</code>:<code>device</code>=<code>device(type='cpu')</code>, <code>tfms</code>:<code>Collection</code>[<code>Callable</code>]=<code>None</code>, <code>num_workers</code>:<code>int</code>=<code>8</code>, <code>collate_fn</code>:<code>Callable</code>=<code>'data_collate'</code>, <code>kwargs</code>:<code>Any</code>)</p>
</blockquote>
<p>Create DeviceDataLoader from <code>dataset</code> with <code>batch_size</code> and <code>shuffle</code>: processs using <code>num_workers</code>. <a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L50">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DeviceDataLoader.create</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=proc_batch></a><code>proc_batch</code></h4>
<blockquote><p><code>proc_batch</code>(<code>b</code>:<code>Tensor</code>) -&gt; <code>Tensor</code></p>
</blockquote>
<p>Proces batch <code>b</code> of <code>TensorImage</code>. <a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L39">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DeviceDataLoader.proc_batch</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4><a id=remove_tfm></a><code>remove_tfm</code></h4>
<blockquote><p><code>remove_tfm</code>(<code>tfm</code>:<code>Callable</code>)
<a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L37">[source]</a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>DeviceDataLoader.remove_tfm</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2><a id=LabelDataset></a><code>class</code> <code>LabelDataset</code></h2>
<blockquote><p><code>LabelDataset</code>() :: <code>DatasetBase</code></p>
</blockquote>
<p>Base class for fastai datasets that do classification. <a href="https://github.com/fastai/fastai/blob/master/fastai/data.py#L15">[source]</a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>LabelDataset</code></p>

</div>
</div>
</div>
</div>
 

